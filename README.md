# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤ CommuniGate Pro

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥–æ–º–µ–Ω–æ–≤ –≤ —Å–µ—Ä–≤–µ—Ä–µ **CommuniGate Pro** (CGP) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ **Let's Encrypt**. –¢–∞–∫–∂–µ –æ–Ω –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å –ª–æ–≥–∞–º–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞ email.

## üìå –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- –û–±–Ω–æ–≤–ª—è–µ—Ç **–∫–ª—é—á, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∏ —Ü–µ–ø–æ—á–∫—É —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤** –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤ –≤ CGP.
- –õ–æ–≥–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ `/var/log/update_cgp_cert.log`.
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** —Å –∏—Ç–æ–≥–∞–º–∏ —Ä–∞–±–æ—Ç—ã.
- –†–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –¥–æ–º–µ–Ω–∞–º–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω –≤ `cron` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤.

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
### 1. –ö–ª–ø–∏—Ä—É–µ–º —Å–∫—Ä–∏–ø—Ç
```
 wget https://github.com/saym101/sysadmin_repo/raw/refs/heads/main/update_cgp_cert.sh

```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
–ü–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ —Å–∫—Ä–∏–ø—Ç–µ:
```bash
DOMAINS=("stpserver.ru talabsk.ru zaweru.ru")  # –£–∫–∞–∂–∏—Ç–µ —Å–≤–æ–∏ –¥–æ–º–µ–Ω—ã
POSTMASTER_NAME="postmaster@stpserver.ru"
POSTMASTER_PASSWORD="Brqada123!"  # –£–∫–∞–∂–∏—Ç–µ —Å–≤–æ–π –ø–∞—Ä–æ–ª—å
NOTIFICATION_EMAIL="postmaster@stpserver.ru"
IP_CGP_SERVER="127.0.0.1"
CLI_PORT="8100"
SMTP_SERVER="127.0.0.1:25"
```

### 3. –î–∞–µ–º –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
```bash
chmod +x update_cgp_cert.sh
```

### 4. –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ –≤—Ä—É—á–Ω—É—é
```bash
./update_cgp_cert.sh
```

### 5. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ CRON
–î–æ–±–∞–≤—å—Ç–µ –≤ `crontab -e` —Å—Ç—Ä–æ–∫—É:
```bash
0 3 * * * /path/to/update_cgp_cert.sh >> /var/log/update_cgp_cert_cron.log 2>&1
```
–≠—Ç–æ—Ç cron-–∑–∞–ø—É—Å–∫ –æ–±–Ω–æ–≤–∏—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00 –Ω–æ—á–∏.

## üìú –õ–æ–≥–∏ –∏ –æ—Ç–ª–∞–¥–∫–∞
–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ –ª–æ–≥-—Ñ–∞–π–ª –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –∑–¥–µ—Å—å:
```bash
cat /var/log/update_cgp_cert.log
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **–ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å –≤ –∫–æ–¥–µ!** –õ—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ —Ö—Ä–∞–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –≤ –∑–∞—â–∏—â—ë–Ω–Ω–æ–º —Ñ–∞–π–ª–µ.
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ **`postmaster` –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ API CommuniGate Pro**.

## üéØ TODO
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ —á–µ—Ä–µ–∑ `certbot`
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ HTTPS-–∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è API CommuniGate Pro
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–æ—Ç–∞—Ü–∏–∏ –ª–æ–≥–æ–≤

---

üìå –ê–≤—Ç–æ—Ä: [–í–∞—à–µ –ò–º—è](https://github.com/your-profile) | üöÄ [GitHub Repo](https://github.com/your-repo/update-cgp-cert)

